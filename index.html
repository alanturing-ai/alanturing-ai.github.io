<!DOCTYPE html>
<html>
<head>
    <title>–ò–≥—Ä–∞ –≤ –õ–∏–∑–∏–Ω–≥</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #f0f0f0;
            --tg-theme-text-color: #000000;
            --tg-theme-button-color: #3498db;
            --tg-theme-button-text-color: #ffffff;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;        
        }
        
        .header {
            font-size: 24px;
            font-weight: bold;
            margin: 10px;
            color: var(--tg-theme-text-color);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
            max-width: 400px;
        }

        .game-info {
            font-size: 20px;
            display: flex;
            justify-content: space-between;
            width: 100%;
            padding: 10px;
            background: var(--tg-theme-bg-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(10, minmax(25px, 30px));
            gap: 1px;
            background-color: #ccc;
            padding: 1px;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: auto;
        }
        
        .cell {
            aspect-ratio: 1;
            background-color: #eee;
            border: 1px solid #999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
            font-size: 16px;
        }
        
        .cell:hover {
            background-color: #e0e0e0;
        }
        
        .cell.revealed {
            background-color: #fff;
        }
        
        .cell.mine {
            background-color: #ff4444;
        }
        
        .cell.flagged {
            background-color: #ffeb3b;
        }

        .game-message {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 100;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 90vw;
        }

        .game-message.show {
            opacity: 1;
            top: -50px;
        }

        .grid-container {
            position: relative;
            margin: 60px 0 20px 0;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .controls {
            margin: 15px;
        }
        
        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        .emoji {
            margin: 0 5px;
        }

        @media (max-width: 360px) {
            .cell {
                font-size: 14px;
            }
            
            .game-info {
                font-size: 16px;
            }
            
            .header {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <span class="emoji">üöó</span>
        –ò–≥—Ä–∞ –≤ –õ–∏–∑–∏–Ω–≥
    </div>
    <div class="game-container">
        <div class="game-info">
            <div>–ú–∏–Ω—ã: <span id="mines-count">10</span></div>
            <div>–í—Ä–µ–º—è: <span id="timer">0</span></div>
        </div>
        <div class="grid-container">
            <div id="gameMessage" class="game-message"></div>
            <div id="grid" class="grid"></div>
        </div>
        <div class="controls">
            <button onclick="initGame()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        </div>
    </div>
<script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ –∏–∑ —Ç–µ–º—ã Telegram
        document.documentElement.style.setProperty('--tg-theme-bg-color', tg.backgroundColor || '#f0f0f0');
        document.documentElement.style.setProperty('--tg-theme-text-color', tg.textColor || '#000000');
        document.documentElement.style.setProperty('--tg-theme-button-color', tg.buttonColor || '#3498db');
        document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.buttonTextColor || '#ffffff');

        // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const GRID_SIZE = 10;
        const MINES_COUNT = 10;
        let grid = [];
        let minesLeft = MINES_COUNT;
        let gameOver = false;
        let timer = 0;
        let timerInterval;
        let gameStarted = false;

        const trollingMessages = [
            "–ü–æ–∫–∞ —Ç—ã –∏–≥—Ä–∞–µ—à—å, —Ç–≤–æ–π –∫–ª–∏–µ–Ω—Ç —É—à–µ–ª –∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º! üèÉ‚Äç‚ôÇÔ∏è",
            "–î–∏—Ä–µ–∫—Ç–æ—Ä: ¬´–ê –≥–¥–µ –æ—Ç—á—ë—Ç –ø–æ —Å–¥–µ–ª–∫–∞–º?¬ª –¢—ã: *–∏–≥—Ä–∞–µ—à—å –≤ —Å–∞–ø—ë—Ä–∞* üéÆ",
            "–¢–≤–æ—è –∑–∞—Ä–ø–ª–∞—Ç–∞ —Ç–∞–∫ –∂–µ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –Ω—É–ª—é, –∫–∞–∫ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø–ª–∞–Ω—É! üìâ",
            "–£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ! –ñ–∞–ª—å, —á—Ç–æ –Ω–µ —É—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞... üòÖ",
            "–ê–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥: *–æ—Ç–∫–∞–∑*, –¢—ã: *–æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –Ω–æ–≤—É—é –∏–≥—Ä—É* ü§¶‚Äç‚ôÇÔ∏è",
            "–ö–ª–∏–µ–Ω—Ç: ¬´–ì–¥–µ –ö–ü?¬ª –¢—ã: *—Å—Ç–∞–≤–∏—à—å –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥ –≤ —Å–∞–ø—ë—Ä–µ* üèÜ",
            "–ö–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞ –±–ª–∏–∑–∫–æ, –∞ —Ç—ã –≤—Å—ë –µ—â—ë –∑–¥–µ—Å—å! ‚è∞",
            "–ü–ª–∞–Ω –≥–æ—Ä–∏—Ç, –∞ —Ç—ã –ø—Ä–æ—Ö–ª–∞–∂–¥–∞–µ—à—å—Å—è! üî•",
            "–ú–æ–∂–µ—Ç —Ö–≤–∞—Ç–∏—Ç —É–∂–µ –∏–≥—Ä–∞—Ç—å? –ê, –ª–∞–¥–Ω–æ, –µ—â—ë –æ–¥–Ω—É... üé≤",
            "–ö–æ–ª–ª–µ–≥–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç —Å–¥–µ–ª–∫–∏, –∞ —Ç—ã –∑–∞–∫—Ä—ã–≤–∞–µ—à—å –∫–ª–µ—Ç–æ—á–∫–∏! üì¶",
            "–ù–æ–≤—ã–π –∫–ª–∏–∫! –ï—Å–ª–∏ –±—ã —ç—Ç–æ –±—ã–ª–∞ –Ω–æ–≤–∞—è –∑–∞—è–≤–∫–∞... üìù",
            "–¢–≤–æ–π –±–æ–Ω—É—Å —Ç–∞–µ—Ç —Å –∫–∞–∂–¥—ã–º –∫–ª–∏–∫–æ–º! üí∏",
            "Skill issue –≤ —Å–∞–ø—ë—Ä–µ –∏–ª–∏ –≤ –ø—Ä–æ–¥–∞–∂–∞—Ö? ü§î",
            "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–ª–æ–Ω—è–µ—à—å—Å—è –æ—Ç —Ä–∞–±–æ—Ç—ã! üéØ",
            "–í–º–µ—Å—Ç–æ –ø–ª–∞–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—à—å –∫–ª–µ—Ç–æ—á–∫–∏? –ì–µ–Ω–∏–∞–ª—å–Ω–æ! üëå"
        ];

        // –ó–∞–ø—Ä–µ—â–∞–µ–º –∑—É–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        function showGameMessage(forcedMessage = null) {
            const messageElement = document.getElementById('gameMessage');
            const message = forcedMessage || trollingMessages[Math.floor(Math.random() * trollingMessages.length)];
            
            messageElement.textContent = message;
            messageElement.classList.add('show');
            
            if (messageElement.hideTimer) {
                clearTimeout(messageElement.hideTimer);
            }
            
            messageElement.hideTimer = setTimeout(() => {
                messageElement.classList.remove('show');
            }, 3500);
        }

        function startTimer() {
            timer = 0;
            gameStarted = true;
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        function updateTimer() {
            timer++;
            document.getElementById('timer').textContent = timer;
        }

        function createGrid() {
            const gridElement = document.getElementById('grid');
            gridElement.innerHTML = '';
            grid = [];
            
            for (let i = 0; i < GRID_SIZE; i++) {
                grid[i] = [];
                for (let j = 0; j < GRID_SIZE; j++) {
                    grid[i][j] = {
                        mine: false,
                        revealed: false,
                        flagged: false,
                        neighborMines: 0
                    };
                    
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.addEventListener('click', handleClick);
                    cell.addEventListener('contextmenu', handleRightClick);
                    cell.addEventListener('touchstart', handleTouchStart);
                    cell.addEventListener('touchend', handleTouchEnd);
                    gridElement.appendChild(cell);
                }
            }
        }
let touchTimer = null;
        let touchDuration = 500;

        function handleTouchStart(event) {
            event.preventDefault();
            touchTimer = setTimeout(() => {
                const row = parseInt(event.target.dataset.row);
                const col = parseInt(event.target.dataset.col);
                handleLongTouch(row, col);
            }, touchDuration);
        }

        function handleTouchEnd(event) {
            event.preventDefault();
            if (touchTimer) {
                clearTimeout(touchTimer);
                const row = parseInt(event.target.dataset.row);
                const col = parseInt(event.target.dataset.col);
                handleClick(event);
            }
        }

        function handleLongTouch(row, col) {
            if (!grid[row][col].revealed) {
                grid[row][col].flagged = !grid[row][col].flagged;
                minesLeft += grid[row][col].flagged ? -1 : 1;
                document.getElementById('mines-count').textContent = minesLeft;
                updateDisplay();
            }
            touchTimer = null;
        }

        function placeMines() {
            let minesPlaced = 0;
            while (minesPlaced < MINES_COUNT) {
                const row = Math.floor(Math.random() * GRID_SIZE);
                const col = Math.floor(Math.random() * GRID_SIZE);
                if (!grid[row][col].mine) {
                    grid[row][col].mine = true;
                    minesPlaced++;
                }
            }
        }

        function calculateNumbers() {
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    if (!grid[i][j].mine) {
                        let count = 0;
                        for (let di = -1; di <= 1; di++) {
                            for (let dj = -1; dj <= 1; dj++) {
                                const ni = i + di;
                                const nj = j + dj;
                                if (ni >= 0 && ni < GRID_SIZE && nj >= 0 && nj < GRID_SIZE) {
                                    if (grid[ni][nj].mine) count++;
                                }
                            }
                        }
                        grid[i][j].neighborMines = count;
                    }
                }
            }
        }

        function handleClick(event) {
            if (gameOver) return;
            
            if (!gameStarted) {
                startTimer();
                showGameMessage("–ù–∞—à—ë–ª –≤—Ä–µ–º—è –ø–æ–∏–≥—Ä–∞—Ç—å? –ú–æ–ª–æ–¥–µ—Ü! üëè");
            }

            const row = parseInt(event.target.dataset.row);
            const col = parseInt(event.target.dataset.col);
            
            if (grid[row][col].flagged) return;
            
            reveal(row, col);
            updateDisplay();
            
            if (grid[row][col].mine) {
                gameOver = true;
                stopTimer();
                revealAll();
                showGameMessage("Game Over! –ö–∞–∫ —Ç–≤–æ–π –ø–ª–∞–Ω –ø—Ä–æ–¥–∞–∂! üí•");
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
                tg.sendData(JSON.stringify({
                    action: 'lose',
                    time: timer
                }));
                setTimeout(() => alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ü—Ä–∏–º–µ—Ä–Ω–æ –∫–∞–∫ —Ç–≤–æ–π –ø–ª–∞–Ω –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º!'), 500);
            } else {
                showGameMessage();
                
                if (checkWin()) {
                    gameOver = true;
                    stopTimer();
                    showGameMessage("–ü–æ–±–µ–¥–∞! –ê –º–æ–≥ –±—ã —Å–¥–µ–ª–∫—É –∑–∞–∫—Ä—ã—Ç—å! üéâ");
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
                    tg.sendData(JSON.stringify({
                        action: 'win',
                        time: timer,
                        score: Math.max(1000 - timer * 10, 100)
                    }));
                    setTimeout(() => alert(`–ü–æ–±–µ–¥–∞! –í–∞—à–µ –≤—Ä–µ–º—è: ${timer} —Å–µ–∫—É–Ω–¥. –ê –º–æ–≥–ª–∏ –±—ã —É–∂–µ 3 —Å–¥–µ–ª–∫–∏ –∑–∞–∫—Ä—ã—Ç—å!`), 500);
                }
            }
        }

        function handleRightClick(event) {
            event.preventDefault();
            if (gameOver) return;
            
            if (!gameStarted) {
                startTimer();
                showGameMessage("–ù–∞—à—ë–ª –≤—Ä–µ–º—è –ø–æ–∏–≥—Ä–∞—Ç—å? –ú–æ–ª–æ–¥–µ—Ü! üëè");
            }

            const row = parseInt(event.target.dataset.row);
            const col = parseInt(event.target.dataset.col);
            
            if (!grid[row][col].revealed) {
                grid[row][col].flagged = !grid[row][col].flagged;
                minesLeft += grid[row][col].flagged ? -1 : 1;
                document.getElementById('mines-count').textContent = minesLeft;
                updateDisplay();
            }
        }

        function reveal(row, col) {
            if (row < 0 || row >= GRID_SIZE || col < 0 || col >= GRID_SIZE) return;
            if (grid[row][col].revealed || grid[row][col].flagged) return;
            
            grid[row][col].revealed = true;
            
            if (grid[row][col].neighborMines === 0 && !grid[row][col].mine) {
                for (let di = -1; di <= 1; di++) {
                    for (let dj = -1; dj <= 1; dj++) {
                        reveal(row + di, col + dj);
                    }
                }
            }
        }

        function revealAll() {
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    grid[i][j].revealed = true;
                }
            }
            updateDisplay();
        }

        function updateDisplay() {
            const cells = document.getElementsByClassName('cell');
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    const cell = cells[i * GRID_SIZE + j];
                    cell.className = 'cell';
                    
                    if (grid[i][j].revealed) {
                        cell.classList.add('revealed');
                        if (grid[i][j].mine) {
                            cell.classList.add('mine');
                            cell.textContent = 'üí£';
                        } else if (grid[i][j].neighborMines > 0) {
                            cell.textContent = grid[i][j].neighborMines;
                        }
                    } else if (grid[i][j].flagged) {
                        cell.classList.add('flagged');
                        cell.textContent = 'üö©';
                    } else {
                        cell.textContent = '';
                    }
                }
            }
        }

        function checkWin() {
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    if (!grid[i][j].mine && !grid[i][j].revealed) return false;
                }
            }
            return true;
        }

        function initGame() {
            gameOver = false;
            gameStarted = false;
            minesLeft = MINES_COUNT;
            stopTimer();
            timer = 0;
            document.getElementById('timer').textContent = '0';
            document.getElementById('mines-count').textContent = minesLeft;
            createGrid();
            placeMines();
            calculateNumbers();
            updateDisplay();
            showGameMessage("–û–ø—è—Ç—å –∏–≥—Ä–∞–µ–º –≤–º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã? –ù—É –¥–∞–≤–∞–π! üéÆ");
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        initGame();
        
        // –°–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –º–∏–Ω–∏-–∞–ø–ø –∑–∞–≥—Ä—É–∂–µ–Ω
        tg.ready();
    </script>
</body>
</html>
